# 04.부호화와 발전
## 스리프트와 프로토콜 버퍼 
- 스리프트와 프롤토콜 버퍼 모두 부호화할 데이터를 위한 스키마 필요
- 스리프트는 스리프트 인터페이스 정의 언어 (IDL)을 사용
- 각각 스키마 정의를 사용해 코드 생성하는 도구가 있고, 애플리케이션은 이를 통해 부호화하고 복호화한다.

### 스키마로 부호화된 데이터 
- 스리프트는 바이너리프로토콜과 컴팩트 프로토콜이라는 두사지 이진 부호화 형식이 있다. 
#### 바이너리프로토콜
- 필드 이름이 없고 부호화된 데이터는 숫자(1, 2, 3)와 같은 필드 태그를 포함한다.

#### 스리프트 컴팩트프로토콜 부호화
- 동일한 정보를 단지 34 바이트로 줄여 부호화한다. 
- 필드 타입과 태그 숫자를 단일 바이트로 줄이고 가변 길이 정수를 사용해 부호화한다.

#### 프로토콜 버퍼
- 같은 데이터를 33바이트로 만듦
- 스리프트 컴팩트프로토콜과 매우 비슷

## 필드 태그와 스키마 발전
- 스키마 발전: 스키마는 필연적으로 변한다.
- 필드태그의 유무는 부호화된 데이터를 해석하기 위해 매우 중요하다.
- 상위호환성 : 필드에 새로운 태그를 부려하면 예전 코드에서는 새로운 코드로 기록한 데이터(예전 코드는 인식할 수 없는 태그 번호 가진 필드)를 읽으려는 경우 무시함 
- 하위 호환성 : 각 필드에 고유한 태그 번호가 있는 동안에는 태그 번호가 계속 같은 의미를 가지고 있기 때문에 새로운 코드가 예전 데이터를 항상 읽음
- 필드 삭제는 optional 필드만 가능하고, 같은 태그 번호는 절대 다시 사용하지 않는다.

## 데이터타입과 스키마 발전
- 프로토콜 버퍼는 목록이라 배열 타입이 없지만, 필드에 repeated 표시자가 있다. 
- (단일값인) optional 필드를 다중값인 repeated 필드로 변경해도 문제가 없다. 
- 스리프트에는 전용 목록 타입이 있다. 프로토콜 버퍼와는 다르게 단일 값에서 다중 값으로의 변경을 허용하지 않지만, 중첩된 목록을 지원한다. 

## 아브로
- 스키마 언어로는 사람이 편집 가능한 아브로 IDL, 기계가 쉽게 읽을 수 있는 JSON 기반 언어
- 스키마에 태그 번호가 없다. 부호화하면 32바이트로 짧다. 
- 필드나 데이터 타입을 식별하기 위한 정보가 없다. 
- 이진 데이터를 파싱하려면 스키마에 나타난 순서대로 필드를 보고 각 필드 데이터 타입을 미리 파악해야 한다. 
- 읽기 쓰기 간 같은 스키마를 사용해야 한다.